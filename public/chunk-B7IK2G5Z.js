import{a as c}from"./chunk-3J7GGTVR.js";import{a as y,b as l}from"./chunk-RAVDJK6K.js";import{q as m}from"./chunk-IK5HEOFA.js";import{e as a}from"./chunk-JHI3MBHO.js";function v(o){o.CapacitorUtils.Synapse=new Proxy({},{get(i,s){return new Proxy({},{get(t,e){return(r,n,p)=>{let w=o.Capacitor.Plugins[s];if(w===void 0){p(new Error(`Capacitor plugin ${s} not found`));return}if(typeof w[e]!="function"){p(new Error(`Method ${e} not found in Capacitor plugin ${s}`));return}a(null,null,function*(){try{let f=yield w[e](r);n(f)}catch(f){p(f)}})}}})}})}function h(o){o.CapacitorUtils.Synapse=new Proxy({},{get(i,s){return o.cordova.plugins[s]}})}function g(o=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!o?v(window):window.cordova!==void 0&&h(window))}var d=l("Filesystem",{web:()=>import("./chunk-JAVDZOHE.js").then(o=>new o.FilesystemWeb)});g();var u=l("Preferences",{web:()=>import("./chunk-3AVLSRRG.js").then(o=>new o.PreferencesWeb)});var U=(()=>{let i=class i{constructor(){this.VIDEOS_KEY="videos",this.videos=[]}loadVideos(){return a(this,null,function*(){let{value:t}=yield u.get({key:this.VIDEOS_KEY});return this.videos=t?JSON.parse(t):[],this.videos})}storeVideo(t){return a(this,null,function*(){let e=this.generateFileName();console.log("[VideoService] Saving video as:",e);let r=yield this.convertBlobToBase64(t);y.getPlatform()==="web"?yield this.saveToDesktop(e,r):yield d.writeFile({path:e,data:r,directory:c.Documents}),this.videos.unshift(e),yield u.set({key:this.VIDEOS_KEY,value:JSON.stringify(this.videos)}),console.log("[VideoService] Video saved and listed.")})}saveToDesktop(t,e){return a(this,null,function*(){try{yield d.writeFile({path:t,data:e,directory:c.External})}catch(r){console.error("Error saving to desktop:",r),yield d.writeFile({path:t,data:e,directory:c.Documents})}})}getVideoUrl(t){return a(this,null,function*(){return`data:video/webm;base64,${(yield d.readFile({path:t,directory:c.Documents})).data}`})}convertBlobToBase64(t){return new Promise((e,r)=>{let n=new FileReader;n.onerror=()=>r(new Error("Blob to Base64 failed")),n.onload=()=>e(n.result),n.readAsDataURL(t)})}generateFileName(){let t=new Date,e=r=>r.toString().padStart(2,"0");return`${e(t.getDate())}-${e(t.getMonth()+1)}-${t.getFullYear()}_${e(t.getHours())}-${e(t.getMinutes())}-${e(t.getSeconds())}-${t.getMilliseconds()}.webm`}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();export{U as a};
